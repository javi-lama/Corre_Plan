<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="description" content="Corre Plan: Herramienta para planificar tareas hospitalarias de manera r√°pida y organizada.">
  <meta name="author" content="Javier A. Lama Agurto">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Corre Plan - Home</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      border-bottom: 1px solid #ccc;
    }
    .branding {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .branding h1 {
      margin: 0;
    }
    .branding img {
      height: 100%;
    }
    .inspirational-text {
      font-style: italic;
      font-size: 16px;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: #f9f9f9;
    }
    .date-nav {
      font-size: 16px;
    }
    .config-button {
      background: #ddd;
      border: none;
      padding: 10px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
    }
    .nav-tabs {
      display: flex;
      overflow-x: auto;
      padding: 10px 20px;
      background: #e8f6f7;
      gap: 10px;
    }
    .nav-tab {
      padding: 14px 18px;
      border-radius: 20px;
      background-color: #00bcd4;
      color: white;
      font-weight: bold;
      white-space: nowrap;
      cursor: pointer;
      transition: background 0.3s ease;
      font-size: 16px;
    }
    .nav-tab.active {
      background-color: white;
      color: #00bcd4;
      border: 2px solid #00bcd4;
    }
    .task-checkboxes {
      display: flex;
      gap: 4px;
      align-items: flex-start;
      justify-content: flex-end;
      margin-top: 0;
    }
    .delete-task {
      cursor: pointer;
      margin-left: 8px;
      font-size: 16px;
      color: #c62828;
      transition: transform 0.2s;
    }
    .delete-task:hover {
      transform: scale(1.2);
    }
    .edit-task {
      cursor: pointer;
      margin-left: 8px;
      font-size: 16px;
      color: #1976d2;
      transition: transform 0.2s;
    }
    .edit-task:hover {
      transform: scale(1.2);
    }
    .completed-task {
      background-color: #e0f7e9;
      border-radius: 10px;
      padding: 4px 6px;
    }

    /* Mejorado bot√≥n submit */
    button[type="submit"] {
      width: 100%;
      background: #00bcd4;
      color: white;
      padding: 10px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    button[type="submit"]:hover {
      background-color: #0097a7;
      transform: translateY(-1px);
    }

    button[type="submit"]:active {
      background-color: #00838f;
      transform: translateY(1px);
    }
  </style>
</head>
<body>
  <noscript>
    <div style="background: #ffcaca; padding: 10px; border: 1px solid red; text-align: center;">
      ‚ö†Ô∏è Esta p√°gina necesita JavaScript activado para funcionar correctamente.
    </div>
  </noscript>
  <header>
    <div class="branding">
      <h1>¬°Corre Plan!</h1>
      <div style="height: 40px; border-left: 2px solid #ccc; margin: 0 15px;"></div>
      <img src="https://emedicina.upch.edu.pe/profesionalismo/img/logo.png" alt="Cayetano Logo" style="height: 40px;" />
    </div>
    <button class="config-button">‚öôÔ∏è Configuraci√≥n</button>
  </header>

  <div class="top-bar">
    <div class="inspirational-text">"Divide y vencer√°s"</div>
    <div class="date-nav">
      <button>‚¨ÖÔ∏è</button>
      <span class="date-display"></span>
      <button>‚û°Ô∏è</button>
    </div>
  </div>

  <nav class="nav-tabs">
    <div class="nav-tab active">ACUMULADO</div>
    <div class="nav-tab">CAMA 1</div>
    <div class="nav-tab">CAMA 2</div>
    <div class="nav-tab">CAMA 3</div>
    <div class="nav-tab">CAMA 4</div>
    <div class="nav-tab">CAMA 5</div>
    <div class="nav-tab">CAMA 6</div>
    <div class="nav-tab">CAMA 7</div>
    <div class="nav-tab">CAMA 8</div>
    <div class="nav-tab">CAMA 9</div>
    <div class="nav-tab">CAMA 10</div>
    <div class="nav-tab">CAMA 11</div>
    <div class="nav-tab">CAMA 12</div>
    <div class="nav-tab">CAMA 13</div>
    <div class="nav-tab">CAMA 14</div>
    <div class="nav-tab">CAMA 15</div>
    <div class="nav-tab">CAMA 16</div>
    <div class="nav-tab">CAMA 17</div>
    <div class="nav-tab">CAMA 18</div>
    <div class="nav-tab">CAMA 19</div>
    <div class="nav-tab">CAMA 20</div>
  </nav>

  <main style="display: flex; padding: 20px; gap: 20px;">
    <!-- Panel de tareas acumuladas -->
    <section style="flex: 2.33; background: #f0f4ff; padding: 20px; border-radius: 10px; display: flex; flex-direction: column; align-items: center;">
      <h2 class="plan-title"></h2>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
        <div>
          <h3>CAMA 1</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 2</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 3</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 4</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 5</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 6</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 7</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 8</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 9</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 10</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 11</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 12</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 13</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 14</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 15</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 16</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 17</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 18</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 19</h3>
          <ul></ul>
        </div>
        <div>
          <h3>CAMA 20</h3>
          <ul></ul>
        </div>
      </div>
    </section>

    <!-- Formulario de a√±adir tarea -->
    <aside style="flex: 0.67; background: linear-gradient(to bottom, #c6ffe2, #c6e9ff); padding: 20px; border-radius: 10px; display: flex; flex-direction: column; align-items: center;">
      <h2>A√±adir tarea</h2>
      <form style="width: 100%;">
        <label for="cama">Cama:</label><br>
        <select id="cama" name="cama" style="width: 100%; max-width: 100%; margin-bottom: 10px;">
          <option value="">Seleccione</option>
          <option value="1">CAMA 1</option>
          <option value="2">CAMA 2</option>
          <option value="3">CAMA 3</option>
          <option value="4">CAMA 4</option>
          <option value="5">CAMA 5</option>
          <option value="6">CAMA 6</option>
          <option value="7">CAMA 7</option>
          <option value="8">CAMA 8</option>
          <option value="9">CAMA 9</option>
          <option value="10">CAMA 10</option>
          <option value="11">CAMA 11</option>
          <option value="12">CAMA 12</option>
          <option value="13">CAMA 13</option>
          <option value="14">CAMA 14</option>
          <option value="15">CAMA 15</option>
          <option value="16">CAMA 16</option>
          <option value="17">CAMA 17</option>
          <option value="18">CAMA 18</option>
          <option value="19">CAMA 19</option>
          <option value="20">CAMA 20</option>
        </select><br>

        <label>Imagen:</label><br>
        <input type="text" id="imagen" name="imagen" style="width: 100%; max-width: 100%; margin-bottom: 10px;" /><br>

        <label>Lab:</label><br>
        <input type="text" id="lab" name="lab" style="width: 100%; max-width: 100%; margin-bottom: 10px;" /><br>

        <label>Interconsulta:</label><br>
        <input type="text" id="interconsulta" name="interconsulta" style="width: 100%; max-width: 100%; margin-bottom: 10px;" /><br>

        <label for="accion">Acci√≥n:</label><br>
        <select id="accion" name="accion" style="width: 100%; max-width: 100%; margin-bottom: 10px;">
          <option value="">Seleccione</option>
          <option value="evolucionar">Evolucionar</option>
          <option value="alta">Alta</option>
          <option value="hc">Hacer HC</option>
        </select><br>

        <label>Otro:</label><br>
        <textarea id="otro" name="otro" rows="3" style="width: 100%; max-width: 100%; margin-bottom: 10px;"></textarea><br>

        <label for="alerta">Alerta temporal:</label><br>
        <select id="alerta" style="width: 100%; max-width: 100%; margin-bottom: 5px;">
          <option value="">Seleccione</option>
          <option value="1">Cada 1 d√≠a</option>
          <option value="2">Cada 2 d√≠as</option>
          <option value="3">Cada 3 d√≠as</option>
          <option value="5">Cada 5 d√≠as</option>
          <option value="7">Cada 7 d√≠as</option>
        </select>

        <button type="submit">A√±adir</button>
      </form>
    </aside>
  </main>
  <section style="background: #eef; padding: 15px 30px; margin: 0 20px 20px 20px; border-radius: 10px; font-size: 15px;">
    <strong>‚ÑπÔ∏è ¬øC√≥mo usar esta herramienta?</strong><br>
    1. Selecciona una cama y escribe una tarea.<br>
    2. Marca los checks cuando est√©n completados.<br>
    3. Usa los √≠conos ‚úèÔ∏è y üóëÔ∏è para editar o borrar.<br>
    4. Las tareas se guardan autom√°ticamente. ‚úÖ
  </section>

  <script>
    const today = new Date();
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    const formattedDate = today.toLocaleDateString('es-PE', options);
    document.querySelectorAll('.date-display').forEach(el => {
      el.innerHTML = `<strong>${formattedDate}</strong>`;
    });
    document.querySelectorAll('.plan-title').forEach(el => {
      el.innerText = `Plan acumulado ‚Ä¢ ${today.toLocaleDateString('es-PE')}`;
    });
  </script>
  <script>
    const accionSelect = document.getElementById('accion');
    const fieldsToDisable = ['imagen', 'lab', 'interconsulta', 'otro'];
    const alertaDropdown = document.getElementById('alerta');
    const usarAlertaDropdown = document.createElement('select');
    usarAlertaDropdown.id = 'usar-alerta';
    usarAlertaDropdown.style.width = '100%';
    usarAlertaDropdown.style.marginBottom = '10px';
    usarAlertaDropdown.innerHTML = `
      <option value="si">S√≠</option>
      <option value="no" selected>No</option>
    `;
    alertaDropdown.before(usarAlertaDropdown);
    alertaDropdown.style.display = 'none';

    usarAlertaDropdown.addEventListener('change', () => {
      alertaDropdown.style.display = usarAlertaDropdown.value === 'si' ? 'block' : 'none';
    });

    accionSelect.addEventListener('change', () => {
      const disable = accionSelect.value !== '';
      fieldsToDisable.forEach(id => {
        const field = document.querySelector(`[name="${id}"]`) || document.getElementById(id);
        if (field) field.disabled = disable;
      });

      const alertaDisabled = accionSelect.value === 'alta' || accionSelect.value === 'hc';
      if (alertaDisabled) {
        usarAlertaDropdown.value = 'no';
        usarAlertaDropdown.dispatchEvent(new Event('change'));
        usarAlertaDropdown.disabled = true;
        alertaDropdown.disabled = true;
      } else {
        usarAlertaDropdown.disabled = false;
        alertaDropdown.disabled = false;
      }
    });
  </script>
<script>
  document.querySelectorAll('.delete-task').forEach(btn => {
    btn.addEventListener('click', function () {
      if (confirm('¬øDeseas eliminar esta tarea?')) {
        const li = this.closest('li');
        if (li) li.remove();
      }
    });
  });
</script>
  <script>
    const form = document.querySelector('form');
    const camaSelect = document.getElementById('cama');
    const imagenInput = document.getElementById('imagen');
    const labInput = document.getElementById('lab');
    const interconsultaInput = document.getElementById('interconsulta');
    const otroTextarea = document.getElementById('otro');
    // Reutilizamos el select ya definido arriba
    // const accionSelect = document.getElementById('accion');

    form.addEventListener('submit', function (e) {
      e.preventDefault();

      const cama = camaSelect.value;
      if (!cama) return alert("Seleccione una cama para a√±adir tarea.");

      let nuevaTarea = '';

      if (accionSelect.value) {
        if (accionSelect.value === 'alta') nuevaTarea = 'Alta m√©dica';
        else if (accionSelect.value === 'hc') nuevaTarea = 'Realizar Historia Cl√≠nica';
        else if (accionSelect.value === 'evolucionar') nuevaTarea = 'Evolucionar paciente';
      }

      if (imagenInput.value.trim()) nuevaTarea += (nuevaTarea ? ' + ' : '') + `Imagen: ${imagenInput.value.trim()}`;
      if (labInput.value.trim()) nuevaTarea += (nuevaTarea ? ' + ' : '') + `Lab: ${labInput.value.trim()}`;
      if (interconsultaInput.value.trim()) nuevaTarea += (nuevaTarea ? ' + ' : '') + `IC: ${interconsultaInput.value.trim()}`;
      if (otroTextarea.value.trim()) nuevaTarea += (nuevaTarea ? ' + ' : '') + otroTextarea.value.trim();

      if (!nuevaTarea) return alert("Debe ingresar al menos un tipo de tarea.");

      // Buscar el <h3> correspondiente y su siguiente <ul>
      let ul = null;
      document.querySelectorAll('h3').forEach(h3 => {
        if (h3.textContent.trim() === `CAMA ${cama}`) {
          ul = h3.nextElementSibling;
        }
      });
      if (!ul) return alert('No se encontr√≥ la cama seleccionada.');

      const li = document.createElement('li');
      li.style.display = 'flex';
      li.style.justifyContent = 'space-between';
      li.style.alignItems = 'flex-start';
      const numChecks = (accionSelect.value === 'alta' || accionSelect.value === 'hc' || accionSelect.value === 'evolucionar') ? 1 : 3;
      let checksHTML = '';
      for (let i = 0; i < numChecks; i++) {
        checksHTML += '<input type="checkbox" /> ';
      }
      li.innerHTML = `
        <span style="max-width: 70%; margin-left: -14px;">${nuevaTarea}</span>
        <div class="task-checkboxes">
          ${checksHTML}
          <span class="edit-task" title="Editar tarea">‚úèÔ∏è</span>
          <span class="delete-task" title="Eliminar tarea">üóëÔ∏è</span>
        </div>
      `;
      ul.appendChild(li);
      // Agregar listeners a los checkboxes para guardarTareas
      li.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', guardarTareas);
      });
      guardarTareas();

      li.querySelector('.delete-task').addEventListener('click', function () {
        if (confirm('¬øDeseas eliminar esta tarea?')) {
          li.remove();
          guardarTareas();
        }
      });

      // Edit task logic
      li.querySelector('.edit-task').addEventListener('click', function () {
        const span = li.querySelector('span');
        const originalText = span.textContent.replace(' ‚úÖ', '').trim();
        const input = document.createElement('input');
        input.type = 'text';
        input.value = originalText;
        input.style.width = '100%';
        input.style.marginLeft = '-14px';
        span.replaceWith(input);
        input.focus();

        const saveEdit = () => {
          const newSpan = document.createElement('span');
          newSpan.style.maxWidth = '70%';
          newSpan.style.marginLeft = '-14px';
          newSpan.textContent = input.value.trim();
          if ([...li.querySelectorAll('input[type="checkbox"]')].every(c => c.checked)) {
            newSpan.classList.add('completed-task');
            newSpan.innerHTML += ' ‚úÖ';
          }
          input.replaceWith(newSpan);
          guardarTareas();
        };

        input.addEventListener('blur', saveEdit);
        input.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            saveEdit();
          }
        });
      });

      // Limpiar formulario
      form.reset();
      alertaDropdown.style.display = 'none';
      usarAlertaDropdown.value = 'no';
      // Rehabilitar campos de texto y el select de acci√≥n para el siguiente uso
      accionSelect.value = '';
      accionSelect.dispatchEvent(new Event('change'));
    });

    function guardarTareas() {
      const datos = {};
      document.querySelectorAll('h3').forEach(h3 => {
        const cama = h3.textContent.trim();
        const ul = h3.nextElementSibling;
        if (ul) {
          datos[cama] = [];
          ul.querySelectorAll('li').forEach(li => {
            const span = li.querySelector('span');
            const checks = [...li.querySelectorAll('input[type="checkbox"]')].map(c => c.checked);
            datos[cama].push({ texto: span.textContent.trim(), checks });

            // Aplicar estilo si todas las casillas est√°n marcadas
            const allChecked = checks.every(c => c === true);
            if (allChecked) {
              span.classList.add('completed-task');
              if (!span.innerHTML.includes('‚úÖ')) {
                span.innerHTML += ' ‚úÖ';
              }
            } else {
              span.classList.remove('completed-task');
              span.innerHTML = span.innerHTML.replace(' ‚úÖ', '');
            }
          });
        }
      });
      localStorage.setItem('tareas', JSON.stringify(datos));
    }

    function cargarTareasGuardadas() {
      // Limpiar todas las listas antes de cargar (para evitar duplicados)
      document.querySelectorAll('h3').forEach(h3 => {
        const ul = h3.nextElementSibling;
        if (ul) ul.innerHTML = '';
      });
      // Cargar tareas guardadas o, si no hay, cargar ejemplos por defecto
      let datos = JSON.parse(localStorage.getItem('tareas') || '{}');
      if (!localStorage.getItem('tareas')) {
        // Si no hay tareas guardadas, cargar ejemplos por defecto
        datos = {};
        for (let i = 1; i <= 20; i++) {
          datos[`CAMA ${i}`] = [
            { texto: 'Ejemplo 1 de tarea', checks: [false, false, false] },
            { texto: 'Ejemplo 2 de tarea', checks: [false, false, false] }
          ];
        }
      }
      for (const cama in datos) {
        const h3 = [...document.querySelectorAll('h3')].find(h => h.textContent.trim() === cama);
        if (!h3) continue;
        const ul = h3.nextElementSibling;
        datos[cama].forEach(({ texto, checks }) => {
          const li = document.createElement('li');
          li.style.display = 'flex';
          li.style.justifyContent = 'space-between';
          li.style.alignItems = 'flex-start';
          let checksHTML = '';
          for (let i = 0; i < checks.length; i++) {
            checksHTML += `<input type="checkbox" ${checks[i] ? 'checked' : ''}/> `;
          }

          li.innerHTML = `
            <span style="max-width: 70%; margin-left: -14px;">${texto}</span>
            <div class="task-checkboxes">
              ${checksHTML}
              <span class="edit-task" title="Editar tarea">‚úèÔ∏è</span>
              <span class="delete-task" title="Eliminar tarea">üóëÔ∏è</span>
            </div>
          `;

          const span = li.querySelector('span');
          const allChecked = checks.every(c => c === true);
          if (allChecked) {
            span.classList.add('completed-task');
            if (!span.innerHTML.includes('‚úÖ')) {
              span.innerHTML += ' ‚úÖ';
            }
          } else {
            span.classList.remove('completed-task');
            span.innerHTML = span.innerHTML.replace(' ‚úÖ', '');
          }
          ul.appendChild(li);
          li.querySelector('.delete-task').addEventListener('click', function () {
            if (confirm('¬øDeseas eliminar esta tarea?')) {
              li.remove();
              guardarTareas();
            }
          });
          li.querySelectorAll('input[type="checkbox"]').forEach(cb => {
            cb.addEventListener('change', guardarTareas);
          });
          // Edit task logic
          li.querySelector('.edit-task').addEventListener('click', function () {
            const span = li.querySelector('span');
            const originalText = span.textContent.replace(' ‚úÖ', '').trim();
            const input = document.createElement('input');
            input.type = 'text';
            input.value = originalText;
            input.style.width = '100%';
            input.style.marginLeft = '-14px';
            span.replaceWith(input);
            input.focus();

            const saveEdit = () => {
              const newSpan = document.createElement('span');
              newSpan.style.maxWidth = '70%';
              newSpan.style.marginLeft = '-14px';
              newSpan.textContent = input.value.trim();
              if ([...li.querySelectorAll('input[type="checkbox"]')].every(c => c.checked)) {
                newSpan.classList.add('completed-task');
                newSpan.innerHTML += ' ‚úÖ';
              }
              input.replaceWith(newSpan);
              guardarTareas();
            };

            input.addEventListener('blur', saveEdit);
            input.addEventListener('keypress', (e) => {
              if (e.key === 'Enter') {
                saveEdit();
              }
            });
          });
        });
      }
    }

    window.addEventListener('load', cargarTareasGuardadas);
    window.addEventListener('beforeunload', guardarTareas);
  </script>
</body>
  <footer style="text-align: center; margin-top: 30px; padding: 12px; font-size: 14px; background-color: #f5f5f5; border-top: 1px solid #ccc;">
    Creado por Javier A. Lama Agurto ‚Äì
    <a href="https://www.instagram.com/javier.lama/" target="_blank" style="color: #c13584; text-decoration: none;">Instagram</a> ‚Äì
    <a href="https://www.linkedin.com/in/javier-augusto-lama-agurto-459035203" target="_blank" style="color: #0a66c2; text-decoration: none;">LinkedIn</a>
  </footer>
</body>
</html>